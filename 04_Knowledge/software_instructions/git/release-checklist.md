
# Release Checklist（发布清单）

> 目标：发布可追溯、可回滚、可交付（尤其适合商业版离线交付）

---

## A. 发布前准备（Pre-release）

### A1. 代码与分支
- [ ] main/master 分支处于可发布状态（无 WIP）
- [ ] 本次发布的所有改动已合并完成（PR 全部关闭/合并）
- [ ] `git status` 干净（无临时文件/日志/数据目录误提交）
- [ ] 提交历史清晰（无明显调试提交/敏感信息）

### A2. 版本与变更记录
- [ ] 确认版本号：`vMAJOR.MINOR.PATCH = __________`
- [ ] 更新 CHANGELOG / Release Notes：
  - [ ] 新功能（feat）
  - [ ] 修复（fix）
  - [ ] 重要变更/迁移说明（breaking / migration）
- [ ] 更新文档（部署、配置、使用说明）如有影响

### A3. 配置与安全
- [ ] `.gitignore` 覆盖运行数据/日志/打包产物
- [ ] 已确认无敏感信息进入仓库（Token/密码/私钥/客户数据）
- [ ] 如涉及密钥（cosign/ssl），确认交付方式（不入库，走安全渠道）

---

## B. 构建与测试（Build & Verification）

### B1. 构建产物
- [ ] 构建 Docker 镜像 / 二进制包成功
- [ ] 镜像 Tag / 包名包含版本号：`vX.Y.Z`
- [ ] 产物可复现（记录构建命令/依赖版本）

### B2. 最小可用验证（必须）
- [ ] 服务可启动
- [ ] 登录/权限基本流程 OK
- [ ] 核心业务流程跑通（按项目实际补充）
  - [ ] 项目创建/审批流程
  - [ ] 镜像上传/关联/下载
  - [ ] 检测任务创建/报告生成/报告下载
  - [ ] 通知/消息（如适用）
- [ ] 关键报错日志检查（无明显 ERROR 堆栈）

### B3. 离线/客户环境专项（如适用）
- [ ] 离线部署包验证通过（无外网依赖）
- [ ] 依赖镜像/安装包齐全（含基础镜像、工具）
- [ ] 数据目录/挂载路径符合交付规范（例如 /data/...）

---

## C. 发布动作（Release）

### C1. 打 Tag
- [ ] 在 main/master 上创建 tag：
  - [ ] `git tag -a vX.Y.Z -m "release vX.Y.Z"`
  - [ ] `git push origin vX.Y.Z`

### C2. 发布说明（Release Notes）
- [ ] 发布说明包含：
  - [ ] 本次变更摘要
  - [ ] 重要风险/兼容性说明
  - [ ] 升级步骤/迁移步骤（如有）
  - [ ] 已知问题（如有）

---

## D. 交付与回滚（Delivery & Rollback）

### D1. 交付物清单（按你实际补充）
- [ ] Docker 镜像包（tar）
- [ ] docker-compose / 部署脚本
- [ ] 配置模板（.env.example 等）
- [ ] 使用文档/部署手册
- [ ] 校验信息（hash/签名，如适用）

### D2. 回滚方案（必须明确）
- [ ] 回滚到上一版本方式明确：
  - [ ] 镜像回滚（tag 回退）
  - [ ] 数据库迁移回退（如涉及）
  - [ ] 配置回退
- [ ] 记录上一稳定版本：`v____`

---

## E. 发布后验证（Post-release）
- [ ] 线上/客户环境验证通过（按最小用例）
- [ ] 收集错误日志/用户反馈
- [ ] 如有 hotfix，按流程开分支 `hotfix/...` 并发补丁版本
